---
title: "MultiGWAS Report "
output: 
 html_document:
    theme: cerulean
    toc: true
    number_sections: false
---

```{r include=FALSE,echo=FALSE}
library(knitr)
library(kableExtra)
```

```{r include=FALSE}
knitr::opts_chunk$set(fig.width=12, fig.height=8, echo=FALSE, warning=FALSE, message=FALSE)
cachedata = FALSE
cachemodels = FALSE
```
```{r echo=FALSE}
read_chunk('gwas-summary-markdown.R')
```
```{r echo=FALSE, message=FALSE}
<<loadLibraries>>
```
```{r echo=FALSE, message=FALSE}
<<msg>>
<<calculateInflationFactor>>
<<markersVennDiagrams>>
```
```{r echo=FALSE, message=FALSE}
<<initParams>>
```
```{r echo=FALSE, message=FALSE}
<<markersSummaryTable>>
snpsTables = markersSummaryTable (inputDir, gwasType, "Structure", outputDir,  nBEST)
```
# Input parameters
```{r  echo=FALSE, message=FALSE, warnings=TRUE}
<<getConfigurationParameters>>
paramsDF = read.table (file="out/out-input-parameters.tbl", header=T, sep="\t")
kable (paramsDF) %>%
 	kable_styling(bootstrap_options = c("striped", "hover", "condensed", font_size=5))
```
# N best ranked SNPs
Venn diagram and table showing the N best ranked SNPs found by each tool and by more than one tool.

## Venn diagran (pdf)
```{r, fig.align = "center", echo=FALSE, message=FALSE, fig.width=5, fig.height=5, fig.fullwidth=TRUE}
knitr::include_graphics ("out/out-summary-gwas-venndiagram-best.png")
```

## SNPs table
```{r  echo=FALSE, message=FALSE}
bestTable = read.table (file="out/out-summary-gwas-best.scores", header=T, sep="\t")
kable (bestTable) %>%
 	kable_styling(bootstrap_options = c("striped", "hover", "condensed", font_size=5))
```

# Significative SNPs
Venn diagram and table showing the signficative SNPs found by each tool and by more than one tool.

## Venn diagran (pdf)
```{r, fig.align = "center", echo=FALSE, message=FALSE, fig.width=5, fig.height=5, fig.fullwidth=TRUE}
knitr::include_graphics ("out/out-summary-gwas-venndiagram-significatives.png")
```

## SNPs table
```{r  echo=FALSE, message=FALSE}
significativesTable = read.table (file="out/out-summary-gwas-significatives.scores", header=T, sep="\t")
kable (significativesTable) %>%
 	kable_styling(bootstrap_options = c("striped", "hover", "condensed", font_size=5))
```

# Manhattan and QQ Plots
Manhattan and QQ plots for the GWAS analysis of the four tools. 

 - The SNPs above the red line were found as significatives for each tool
 - The SNPs above the blue line correspond to the N best ranked SNPs for each tool
 - SNPs marked in green were found by more than one tool.
```{r  fig.widht=11, fig.height=30, fig.fullwidth=TRUE}
knitr::include_graphics ("out/out-summary.manhattan-qq-plots.png")
```

